<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <title>Nahora Delivery</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #ff6b35;
            --primary-dark: #e55a2b;
            --primary-light: #ff8c5a;
            --secondary: #2c3e50;
            --secondary-light: #34495e;
            --light: #f8f9fa;
            --dark: #343a40;
            --success: #28a745;
            --success-light: #34ce57;
            --danger: #dc3545;
            --danger-light: #e4606d;
            --warning: #ffc107;
            --info: #17a2b8;
            --gray-100: #f8f9fa;
            --gray-200: #e9ecef;
            --gray-300: #dee2e6;
            --gray-400: #ced4da;
            --gray-500: #adb5bd;
            --gray-600: #6c757d;
            --gray-700: #495057;
            --gray-800: #343a40;
            --gray-900: #212529;
            --shadow: 0 4px 20px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 30px rgba(0,0,0,0.15);
            --border-radius: 16px;
            --border-radius-sm: 8px;
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: var(--dark);
            overflow-x: hidden;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
            width: 100%;
        }
        
        /* Header Responsivo */
        header {
            background-color: white;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
            transition: var(--transition);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-shrink: 0;
            text-decoration: none;
        }
        
        .logo h1 {
            color: var(--primary);
            font-size: clamp(1.4rem, 4vw, 1.8rem);
            white-space: nowrap;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .logo i {
            color: var(--primary);
            font-size: clamp(1.4rem, 4vw, 1.8rem);
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .nav-links {
            display: flex;
            gap: clamp(10px, 3vw, 20px);
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .nav-links a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: var(--transition);
            font-size: clamp(0.9rem, 2.5vw, 1rem);
            white-space: nowrap;
            padding: 8px 12px;
            border-radius: var(--border-radius-sm);
            position: relative;
        }
        
        .nav-links a:hover {
            color: var(--primary);
            background-color: rgba(255, 107, 53, 0.1);
        }
        
        .nav-links a.active {
            color: var(--primary);
            font-weight: 600;
        }
        
        .nav-links a.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 12px;
            right: 12px;
            height: 2px;
            background: linear-gradient(90deg, var(--primary) 0%, var(--primary-dark) 100%);
            border-radius: 2px;
        }
        
        .header-actions {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-shrink: 0;
        }
        
        .cart-icon {
            position: relative;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: var(--transition);
        }
        
        .cart-icon:hover {
            background-color: rgba(255, 107, 53, 0.1);
            transform: scale(1.05);
        }
        
        .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 0.8rem;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .admin-btn {
            background: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-light) 100%);
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
            white-space: nowrap;
            font-weight: 500;
            box-shadow: 0 4px 10px rgba(44, 62, 80, 0.2);
        }
        
        .admin-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(44, 62, 80, 0.3);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--secondary);
            flex-wrap: wrap;
            font-weight: 500;
        }
        
        .logout-btn {
            background: none;
            border: none;
            color: var(--danger);
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 8px 12px;
            border-radius: var(--border-radius-sm);
            transition: var(--transition);
            font-weight: 500;
        }

        .logout-btn:hover {
            background-color: rgba(220, 53, 69, 0.1);
            transform: translateY(-1px);
        }

        /* Status Banner Responsivo */
        .status-banner {
            padding: 12px 0;
            text-align: center;
            font-weight: 600;
            position: relative;
            z-index: 99;
            font-size: clamp(0.8rem, 3vw, 0.95rem);
            transition: var(--transition);
        }

        .status-banner.open {
            background: linear-gradient(90deg, rgba(40, 167, 69, 0.1) 0%, rgba(52, 206, 87, 0.1) 100%);
            color: var(--success);
            border-bottom: 2px solid var(--success);
        }

        .status-banner.closed {
            background: linear-gradient(90deg, rgba(220, 53, 69, 0.1) 0%, rgba(228, 96, 109, 0.1) 100%);
            color: var(--danger);
            border-bottom: 2px solid var(--danger);
        }

        .status-banner .status-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .status-banner .status-message {
            margin: 0;
            font-size: inherit;
        }

        /* Loading States Corrigido - SEM PISCAR */
        .loading {
            position: relative;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .loading::after {
            content: '';
            width: 40px;
            height: 40px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Login Modal Responsivo */
        .login-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            padding: 20px;
            backdrop-filter: blur(5px);
        }
        
        .login-modal.active {
            opacity: 1;
            visibility: visible;
        }
        
        .login-content {
            background-color: white;
            border-radius: var(--border-radius);
            width: 100%;
            max-width: 400px;
            padding: clamp(20px, 5vw, 30px);
            box-shadow: var(--shadow-lg);
            transform: translateY(20px);
            transition: var(--transition);
        }
        
        .login-modal.active .login-content {
            transform: translateY(0);
        }
        
        .login-header {
            text-align: center;
            margin-bottom: 25px;
        }
        
        .login-header h2 {
            color: var(--secondary);
            margin-bottom: 10px;
            font-size: clamp(1.3rem, 4vw, 1.5rem);
            font-weight: 700;
        }
        
        .login-form .form-group {
            margin-bottom: 20px;
        }
        
        .login-form label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--secondary);
            font-size: clamp(0.9rem, 3vw, 1rem);
        }
        
        .login-form .form-control {
            width: 100%;
            padding: 14px;
            border: 1px solid var(--gray-300);
            border-radius: var(--border-radius-sm);
            font-size: 1rem;
            transition: var(--transition);
            background-color: var(--gray-100);
        }

        .login-form .form-control:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
            background-color: white;
        }
        
        .login-btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border: none;
            border-radius: var(--border-radius-sm);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1rem;
            box-shadow: 0 4px 10px rgba(255, 107, 53, 0.3);
        }
        
        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(255, 107, 53, 0.4);
        }
        
        /* Hero Section Responsiva */
        .hero {
            background: linear-gradient(135deg, rgba(255,107,53,0.85) 0%, rgba(44,62,80,0.9) 100%), 
                        url('https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: white;
            padding: clamp(60px, 12vw, 100px) 0;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23ffffff' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E");
            opacity: 0.3;
        }
        
        .hero h2 {
            font-size: clamp(2rem, 7vw, 3rem);
            margin-bottom: 20px;
            line-height: 1.2;
            font-weight: 800;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        .hero p {
            font-size: clamp(1.1rem, 3vw, 1.3rem);
            max-width: 600px;
            margin: 0 auto 30px;
            line-height: 1.5;
            opacity: 0.9;
        }
        
        .btn {
            display: inline-block;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: clamp(12px, 3vw, 14px) clamp(24px, 4vw, 28px);
            border-radius: 30px;
            text-decoration: none;
            font-weight: 600;
            transition: var(--transition);
            border: none;
            cursor: pointer;
            font-size: clamp(0.9rem, 2.5vw, 1rem);
            text-align: center;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: var(--transition);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 107, 53, 0.4);
        }
        
        .btn:hover::before {
            left: 100%;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        /* Categories Responsivo */
        .categories {
            padding: clamp(40px, 8vw, 60px) 0;
        }
        
        .section-title {
            text-align: center;
            margin-bottom: clamp(30px, 6vw, 50px);
            font-size: clamp(1.6rem, 5vw, 2.2rem);
            color: var(--secondary);
            line-height: 1.2;
            font-weight: 700;
            position: relative;
        }
        
        .section-title::after {
            content: '';
            display: block;
            width: 80px;
            height: 4px;
            background: linear-gradient(90deg, var(--primary) 0%, var(--primary-dark) 100%);
            margin: 15px auto 0;
            border-radius: 2px;
        }
        
        .category-filters {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }
        
        .category-btn {
            background-color: white;
            border: 2px solid var(--gray-300);
            padding: 12px 20px;
            border-radius: 30px;
            cursor: pointer;
            transition: var(--transition);
            font-size: clamp(0.8rem, 2.5vw, 0.9rem);
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .category-btn::before {
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            font-size: 0.9rem;
        }
        
        .category-btn[data-category="Pizzas"]::before {
            content: '🍕';
        }
        
        .category-btn[data-category="Lanches"]::before {
            content: '🍔';
        }
        
        .category-btn[data-category="Bebidas"]::before {
            content: '🥤';
        }
        
        .category-btn[data-category="Sobremesas"]::before {
            content: '🍰';
        }
        
        .category-btn[data-category="all"]::before {
            content: '📋';
        }
        
        .category-btn.active, .category-btn:hover {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255,107,53,0.3);
        }
        
        /* Products Grid Responsivo */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: clamp(20px, 4vw, 30px);
            position: relative;
        }
        
        .product-card {
            background-color: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            height: 100%;
            position: relative;
        }
        
        .product-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary) 0%, var(--secondary) 100%);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .product-card:hover::before {
            transform: scaleX(1);
        }
        
        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-lg);
        }
        
        /* Product Images - Melhorado */
        .product-image {
            height: 220px;
            width: 100%;
            object-fit: cover;
            transition: transform 0.4s ease;
            background: linear-gradient(135deg, var(--gray-100) 0%, var(--gray-200) 100%);
            position: relative;
        }

        .product-card:hover .product-image {
            transform: scale(1.08);
        }

        /* Efeito de brilho na imagem ao passar o mouse */
        .product-card:hover .product-image::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 100%);
            pointer-events: none;
        }
        
        .product-info {
            padding: 24px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .product-name {
            font-size: 1.3rem;
            margin-bottom: 12px;
            color: var(--secondary);
            line-height: 1.3;
            font-weight: 600;
        }
        
        .product-description {
            color: var(--gray-600);
            font-size: 0.95rem;
            margin-bottom: 20px;
            line-height: 1.4;
            flex: 1;
        }
        
        .product-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: auto;
        }
        
        .product-price {
            font-weight: 700;
            font-size: 1.4rem;
            color: var(--primary);
        }
        
        .add-to-cart {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border: none;
            width: 46px;
            height: 46px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1.1rem;
            box-shadow: 0 4px 10px rgba(255, 107, 53, 0.3);
        }
        
        .add-to-cart:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 15px rgba(255, 107, 53, 0.4);
        }

        .add-to-cart:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        /* Cart Sidebar Responsivo */
        .cart-sidebar {
            position: fixed;
            top: 0;
            right: -100%;
            width: 100%;
            max-width: 420px;
            height: 100vh;
            background-color: white;
            box-shadow: -5px 0 25px rgba(0,0,0,0.15);
            transition: right 0.4s ease;
            z-index: 1000;
            display: flex;
            flex-direction: column;
        }
        
        .cart-sidebar.active {
            right: 0;
        }
        
        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 24px;
            border-bottom: 1px solid var(--gray-300);
            background: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-light) 100%);
            color: white;
        }

        .cart-header h3 {
            margin: 0;
            font-size: 1.4rem;
            font-weight: 600;
        }
        
        .close-cart {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: white;
            padding: 8px;
            border-radius: 50%;
            transition: var(--transition);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .close-cart:hover {
            background-color: rgba(255,255,255,0.1);
            transform: rotate(90deg);
        }
        
        .cart-items {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }
        
        .cart-item {
            display: flex;
            gap: 15px;
            padding: 18px 0;
            border-bottom: 1px solid var(--gray-300);
            align-items: flex-start;
            transition: var(--transition);
        }
        
        .cart-item:hover {
            background-color: var(--gray-100);
            margin: 0 -10px;
            padding: 18px 10px;
            border-radius: var(--border-radius-sm);
        }
        
        /* Cart Images - Melhorado */
        .cart-item-image {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 12px;
            flex-shrink: 0;
            border: 2px solid var(--gray-200);
            transition: var(--transition);
            background: linear-gradient(135deg, var(--gray-100) 0%, var(--gray-200) 100%);
        }

        .cart-item:hover .cart-item-image {
            border-color: var(--primary);
            transform: scale(1.05);
        }
        
        .cart-item-details {
            flex: 1;
            min-width: 0;
        }
        
        .cart-item-name {
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 1rem;
            line-height: 1.3;
            color: var(--secondary);
        }
        
        .cart-item-price {
            color: var(--primary);
            font-weight: 700;
            font-size: 1.1rem;
        }
        
        .cart-item-actions {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 12px;
            flex-wrap: wrap;
        }
        
        .quantity-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: 1px solid var(--gray-400);
            background: none;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
        }

        .quantity-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            transform: scale(1.1);
        }
        
        .remove-item {
            color: var(--danger);
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            font-size: 0.9rem;
            border-radius: var(--border-radius-sm);
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: 500;
        }
        
        .remove-item:hover {
            background-color: rgba(220, 53, 69, 0.1);
            transform: translateY(-1px);
        }
        
        .cart-footer {
            padding: 24px;
            border-top: 1px solid var(--gray-300);
            background: var(--gray-100);
        }
        
        .cart-total {
            display: flex;
            justify-content: space-between;
            margin-bottom: 24px;
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--secondary);
        }
        
        .checkout-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border: none;
            border-radius: var(--border-radius-sm);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1.1rem;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
        }
        
        .checkout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 53, 0.4);
        }

        .checkout-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        /* Checkout Modal Responsivo */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            padding: 20px;
            backdrop-filter: blur(5px);
        }
        
        .modal.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background-color: white;
            border-radius: var(--border-radius);
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            padding: clamp(24px, 4vw, 32px);
            box-shadow: var(--shadow-lg);
            transform: translateY(20px);
            transition: var(--transition);
        }
        
        .modal.active .modal-content {
            transform: translateY(0);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--gray-300);
        }

        .modal-header h3 {
            margin: 0;
            color: var(--secondary);
            font-size: clamp(1.3rem, 4vw, 1.6rem);
            font-weight: 700;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray-600);
            padding: 8px;
            border-radius: 50%;
            transition: var(--transition);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .close-modal:hover {
            background-color: var(--gray-200);
            transform: rotate(90deg);
        }
        
        .form-group {
            margin-bottom: 24px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--secondary);
            font-size: 0.95rem;
        }
        
        .form-control {
            width: 100%;
            padding: 14px;
            border: 1px solid var(--gray-300);
            border-radius: var(--border-radius-sm);
            font-size: 1rem;
            transition: var(--transition);
            background-color: var(--gray-100);
        }

        .form-control:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
            background-color: white;
        }
        
        .payment-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
            margin-bottom: 24px;
        }
        
        .payment-option {
            text-align: center;
            padding: 20px 15px;
            border: 2px solid var(--gray-300);
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            transition: var(--transition);
            background: white;
        }
        
        .payment-option.active {
            border-color: var(--primary);
            background-color: rgba(255, 107, 53, 0.1);
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(255, 107, 53, 0.2);
        }

        .payment-option:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }
        
        .payment-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--secondary);
            transition: var(--transition);
        }

        .payment-option.active .payment-icon {
            color: var(--primary);
            transform: scale(1.1);
        }
        
        /* Admin Panel Responsivo */
        .admin-panel {
            padding: clamp(40px, 8vw, 60px) 0;
            display: none;
        }
        
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .admin-tabs {
            display: flex;
            border-bottom: 1px solid var(--gray-300);
            margin-bottom: 30px;
            flex-wrap: wrap;
            overflow-x: auto;
        }
        
        .admin-tab {
            padding: 16px 24px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
            transition: var(--transition);
            font-size: 0.95rem;
            font-weight: 500;
            color: var(--gray-600);
        }
        
        .admin-tab.active {
            border-bottom-color: var(--primary);
            color: var(--primary);
            font-weight: 600;
        }

        .admin-tab:hover {
            background: var(--gray-100);
            color: var(--primary);
        }
        
        .admin-content {
            display: none;
        }
        
        .admin-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .product-form {
            background-color: white;
            padding: clamp(24px, 4vw, 32px);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .image-upload-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        /* Image Preview - Melhorado */
        .image-preview {
            width: 100%;
            max-width: 250px;
            height: 180px;
            border: 2px dashed var(--gray-400);
            border-radius: var(--border-radius-sm);
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            background: linear-gradient(135deg, var(--gray-100) 0%, var(--gray-200) 100%);
            transition: var(--transition);
            position: relative;
            cursor: pointer;
        }

        .image-preview:hover {
            border-color: var(--primary);
            background: linear-gradient(135deg, var(--gray-200) 0%, var(--gray-300) 100%);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .image-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .image-preview:hover img {
            transform: scale(1.05);
        }
        
        .upload-btn {
            background: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-light) 100%);
            color: white;
            border: none;
            padding: 12px 18px;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            width: fit-content;
            transition: var(--transition);
            font-size: 0.9rem;
            font-weight: 500;
            box-shadow: 0 4px 10px rgba(44, 62, 80, 0.2);
        }
        
        .upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(44, 62, 80, 0.3);
        }

        /* Status Toggle Buttons */
        .status-toggle {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .status-btn {
            padding: 18px;
            font-size: 1rem;
            transition: var(--transition);
            border: none;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-weight: 600;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .status-btn.active {
            transform: scale(1.02);
            box-shadow: 0 6px 15px rgba(0,0,0,0.2);
        }

        .status-btn:not(.active) {
            opacity: 0.8;
        }
        
        /* Footer Responsivo */
        footer {
            background: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-light) 100%);
            color: white;
            padding: clamp(40px, 8vw, 60px) 0 20px;
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 30px;
        }
        
        .footer-column h3 {
            margin-bottom: 24px;
            font-size: 1.3rem;
            color: white;
            font-weight: 600;
            position: relative;
        }
        
        .footer-column h3::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 40px;
            height: 3px;
            background: var(--primary);
            border-radius: 2px;
        }
        
        .footer-column ul {
            list-style: none;
        }
        
        .footer-column ul li {
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .footer-column a {
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            transition: var(--transition);
        }
        
        .footer-column a:hover {
            color: white;
            transform: translateX(5px);
        }
        
        .social-links {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }
        
        .social-links a {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 45px;
            height: 45px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            transition: var(--transition);
            color: white;
            text-decoration: none;
            font-size: 1.1rem;
            backdrop-filter: blur(10px);
        }
        
        .social-links a:hover {
            background: var(--primary);
            transform: translateY(-3px) scale(1.1);
            box-shadow: 0 8px 20px rgba(255,107,53,0.3);
        }
        
        .copyright {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid rgba(255,255,255,0.1);
            font-size: 0.9rem;
            color: rgba(255,255,255,0.7);
        }
        
        /* Overlay */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            backdrop-filter: blur(5px);
        }
        
        .overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 20px;
            border-radius: var(--border-radius-sm);
            color: white;
            font-weight: 500;
            z-index: 3000;
            max-width: min(90vw, 350px);
            animation: slideIn 0.3s ease-out;
            box-shadow: var(--shadow-lg);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .notification.success {
            background: linear-gradient(135deg, var(--success) 0%, var(--success-light) 100%);
        }
        
        .notification.danger {
            background: linear-gradient(135deg, var(--danger) 0%, var(--danger-light) 100%);
        }
        
        .notification.warning {
            background: linear-gradient(135deg, var(--warning) 0%, #ffd54f 100%);
            color: var(--dark);
        }
        
        .notification.info {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        /* Order Styles */
        .order-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 24px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            transition: var(--transition);
        }

        .order-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .order-status {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
        }
        
        .order-status.pending {
            background: var(--warning);
            color: white;
        }
        
        .order-status.confirmed {
            background: var(--info);
            color: white;
        }
        
        .order-status.delivered {
            background: var(--success);
            color: white;
        }
        
        .order-status.cancelled {
            background: var(--danger);
            color: white;
        }
        
        /* ==================== RESPONSIVE BREAKPOINTS ==================== */
        
        /* Tablets */
        @media (max-width: 1024px) {
            .header-content {
                justify-content: center;
                text-align: center;
            }
            
            .nav-links {
                order: 3;
                width: 100%;
                justify-content: center;
                margin-top: 10px;
            }
        }
        
        /* Mobile Large */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-links {
                order: 0;
                width: auto;
                margin-top: 0;
            }
            
            .header-actions {
                width: 100%;
                justify-content: center;
            }
            
            .products-grid {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 15px;
            }
            
            .cart-sidebar {
                max-width: 100%;
            }
            
            .form-row {
                grid-template-columns: 1fr;
                gap: 0;
            }
            
            .admin-tabs {
                flex-direction: column;
            }
            
            .admin-tab {
                text-align: center;
                padding: 15px;
            }
            
            .status-banner .status-content {
                flex-direction: column;
                gap: 5px;
            }
            
            .status-toggle {
                grid-template-columns: 1fr;
            }
            
            .payment-options {
                grid-template-columns: 1fr;
            }
        }
        
        /* Mobile Small */
        @media (max-width: 480px) {
            .container {
                padding: 0 10px;
            }
            
            .logo {
                flex-direction: column;
                text-align: center;
                gap: 5px;
            }
            
            .products-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .product-card {
                margin: 0 5px;
            }
            
            .category-filters {
                gap: 8px;
            }
            
            .category-btn {
                padding: 10px 16px;
                font-size: 0.8rem;
            }
            
            .hero {
                padding: 40px 0;
            }
            
            .modal-content {
                margin: 10px;
                padding: 20px 15px;
            }
            
            .cart-item {
                flex-direction: column;
                text-align: center;
            }
            
            .cart-item-image {
                align-self: center;
            }
        }

        /* Very small screens */
        @media (max-width: 360px) {
            .logo h1 {
                font-size: 1.2rem;
            }
            
            .nav-links a {
                font-size: 0.8rem;
            }
            
            .admin-btn {
                padding: 8px 14px;
                font-size: 0.8rem;
            }
            
            .user-info {
                flex-direction: column;
                gap: 5px;
                text-align: center;
            }
            
            .product-info {
                padding: 15px;
            }
            
            .product-name {
                font-size: 1.1rem;
            }
            
            .product-price {
                font-size: 1.1rem;
            }
        }

        /* High-resolution screens */
        @media (min-width: 1400px) {
            .container {
                max-width: 1320px;
            }
            
            .products-grid {
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            }
        }

        /* Print styles */
        @media print {
            .header-actions,
            .admin-panel,
            .cart-sidebar,
            .modal,
            .overlay,
            .notification {
                display: none !important;
            }
        }

        /* Reduced motion for accessibility */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            :root {
                --light: #2d3748;
                --dark: #f7fafc;
            }
            
            body {
                background-color: #1a202c;
                color: var(--dark);
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <a href="#" class="logo">
                    <i class="fas fa-utensils"></i>
                    <h1>Nahora Delivery</h1>
                </a>
                <nav class="nav-links">
                    <a href="#" class="active">Início</a>
                    <a href="#menu">Cardápio</a>
                    <a href="#about">Sobre</a>
                    <a href="#contact">Contato</a>
                </nav>
                <div class="header-actions">
                    <div id="userSection">
                        <button class="admin-btn" id="adminBtn">
                            <i class="fas fa-cog"></i>
                            <span>Admin</span>
                        </button>
                    </div>
                    <div class="cart-icon" id="cartIcon">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="cart-count">0</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Status Banner será inserido aqui via JavaScript -->

    <!-- Login Modal -->
    <div class="login-modal" id="loginModal">
        <div class="login-content">
            <div class="login-header">
                <h2>Acesso Administrativo</h2>
                <p>Faça login para acessar o painel</p>
            </div>
            <form class="login-form" id="loginForm">
                <div class="form-group">
                    <label for="username">Usuário</label>
                    <input type="text" id="username" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="password">Senha</label>
                    <input type="password" id="password" class="form-control" required>
                </div>
                <button type="submit" class="login-btn">Entrar</button>
            </form>
        </div>
    </div>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <h2>Sabores que chegam até você</h2>
            <p>Peça suas comidas favoritas no conforto da sua casa. Entrega rápida e segura.</p>
            <a href="#menu" class="btn">Ver Cardápio</a>
        </div>
    </section>

    <!-- Menu Section -->
    <section class="categories" id="menu">
        <div class="container">
            <h2 class="section-title">Nosso Cardápio</h2>
            
            <div class="category-filters">
                <button class="category-btn active" data-category="all">Todos</button>
                <button class="category-btn" data-category="Pizzas">Pizzas</button>
                <button class="category-btn" data-category="Lanches">Lanches</button>
                <button class="category-btn" data-category="Bebidas">Bebidas</button>
                <button class="category-btn" data-category="Sobremesas">Sobremesas</button>
            </div>
            
            <div class="products-grid" id="productsGrid">
                <!-- Os produtos serão carregados aqui -->
            </div>
        </div>
    </section>

    <!-- Cart Sidebar -->
    <div class="cart-sidebar" id="cartSidebar">
        <div class="cart-header">
            <h3>Seu Carrinho</h3>
            <button class="close-cart" id="closeCart">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="cart-items" id="cartItems">
            <p style="text-align: center; padding: 20px;">Seu carrinho está vazio</p>
        </div>
        <div class="cart-footer">
            <div class="cart-total">
                <span>Total:</span>
                <span id="cartTotal">R$ 0,00</span>
            </div>
            <button class="checkout-btn" id="checkoutBtn">Finalizar Pedido</button>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div class="modal" id="checkoutModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Finalizar Pedido</h3>
                <button class="close-modal" id="closeCheckoutModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="checkoutForm">
                <h4 style="margin-bottom: 15px; color: var(--secondary);">Dados de Entrega</h4>
                <div class="form-group">
                    <label for="customerName">Nome Completo *</label>
                    <input type="text" id="customerName" class="form-control" required placeholder="Digite seu nome completo">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="customerPhone">Telefone *</label>
                        <input type="tel" id="customerPhone" class="form-control" required placeholder="(21) 99999-9999">
                    </div>
                    <div class="form-group">
                        <label for="customerEmail">E-mail</label>
                        <input type="email" id="customerEmail" class="form-control" placeholder="seu@email.com">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="deliveryAddress">Endereço de Entrega *</label>
                    <input type="text" id="deliveryAddress" class="form-control" required placeholder="Rua, número, bairro, complemento">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="deliveryCity">Cidade *</label>
                        <input type="text" id="deliveryCity" class="form-control" required placeholder="Rio de Janeiro">
                    </div>
                    <div class="form-group">
                        <label for="deliveryZip">CEP</label>
                        <input type="text" id="deliveryZip" class="form-control" placeholder="00000-000">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="deliveryNotes">Observações</label>
                    <textarea id="deliveryNotes" class="form-control" rows="3" placeholder="Ponto de referência, instruções de entrega, etc."></textarea>
                </div>
                
                <h4 style="margin-bottom: 15px; color: var(--secondary);">Forma de Pagamento *</h4>
                <div class="payment-options">
                    <div class="payment-option" data-payment="dinheiro">
                        <div class="payment-icon">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <div>Dinheiro</div>
                    </div>
                    <div class="payment-option" data-payment="cartao">
                        <div class="payment-icon">
                            <i class="fas fa-credit-card"></i>
                        </div>
                        <div>Cartão</div>
                    </div>
                    <div class="payment-option" data-payment="pix">
                        <div class="payment-icon">
                            <i class="fas fa-qrcode"></i>
                        </div>
                        <div>PIX</div>
                    </div>
                </div>
                <input type="hidden" id="selectedPayment" name="paymentMethod" required>
                
                <div class="form-group" id="changeField" style="display: none;">
                    <label for="changeFor">Troco para</label>
                    <input type="text" id="changeFor" class="form-control" placeholder="R$ 0,00">
                </div>
                
                <button type="submit" class="btn" style="width: 100%; margin-top: 20px;">
                    <i class="fab fa-whatsapp"></i> Enviar Pedido via WhatsApp
                </button>
                <p style="text-align: center; margin-top: 10px; font-size: 0.9rem; color: #666;">
                    Seu pedido será enviado para o WhatsApp da loja
                </p>
            </form>
        </div>
    </div>

    <!-- Admin Panel -->
    <section class="admin-panel" id="adminPanel">
        <div class="container">
            <div class="admin-header">
                <h2 class="section-title">Painel Administrativo</h2>
                <div class="user-info">
                    <span>Olá, <strong id="adminUserName">Admin</strong></span>
                    <button class="logout-btn" id="logoutBtn">
                        <i class="fas fa-sign-out-alt"></i> Sair
                    </button>
                </div>
            </div>
            
            <div class="admin-tabs">
                <div class="admin-tab active" data-tab="products">Gerenciar Produtos</div>
                <div class="admin-tab" data-tab="orders">Pedidos</div>
                <div class="admin-tab" data-tab="status">Status da Loja</div>
                <div class="admin-tab" data-tab="settings">Configurações</div>
            </div>
            
            <div class="admin-content active" id="productsTab">
                <div class="product-form">
                    <h3 style="margin-bottom: 20px; color: var(--secondary);">Adicionar/Editar Produto</h3>
                    <form id="productForm">
                        <div class="form-group">
                            <label>Imagem do Produto</label>
                            <div class="image-upload-container">
                                <div class="image-preview" id="imagePreview">
                                    <span style="color: #666; text-align: center; padding: 20px;">Nenhuma imagem selecionada</span>
                                </div>
                                <input type="file" id="productImage" accept="image/*" style="display: none;">
                                <button type="button" class="upload-btn" id="uploadImageBtn">
                                    <i class="fas fa-upload"></i> Selecionar Imagem
                                </button>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="productName">Nome do Produto</label>
                                <input type="text" id="productName" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="productPrice">Preço (R$)</label>
                                <input type="number" id="productPrice" class="form-control" step="0.01" min="0" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="productCategory">Categoria</label>
                            <select id="productCategory" class="form-control" required>
                                <option value="">Selecione uma categoria</option>
                                <option value="Pizzas">Pizzas</option>
                                <option value="Lanches">Lanches</option>
                                <option value="Bebidas">Bebidas</option>
                                <option value="Sobremesas">Sobremesas</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="productDescription">Descrição</label>
                            <textarea id="productDescription" class="form-control" rows="3" required></textarea>
                        </div>
                        
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <button type="submit" class="btn">Salvar Produto</button>
                            <button type="button" class="btn" style="background-color: #6c757d;" id="cancelEdit">Cancelar</button>
                        </div>
                    </form>
                </div>
                
                <div style="margin-top: 40px;">
                    <h3 style="margin-bottom: 20px; color: var(--secondary);">Produtos Cadastrados</h3>
                    <div class="products-grid" id="adminProductsGrid">
                        <!-- Produtos admin serão carregados aqui -->
                    </div>
                </div>
            </div>
            
            <div class="admin-content" id="ordersTab">
                <h3 style="margin-bottom: 20px; color: var(--secondary);">Pedidos Recebidos</h3>
                <div id="ordersList">
                    <div style="text-align: center; padding: 40px; background: white; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.1);">
                        <i class="fas fa-clipboard-list" style="font-size: 3rem; color: #ccc; margin-bottom: 15px;"></i>
                        <h3 style="color: #666; margin-bottom: 10px;">Nenhum pedido recebido ainda</h3>
                        <p style="color: #888;">Quando os clientes fizerem pedidos, eles aparecerão aqui.</p>
                    </div>
                </div>
            </div>

            <!-- Nova Aba: Status da Loja -->
            <div class="admin-content" id="statusTab">
                <h3 style="margin-bottom: 20px; color: var(--secondary);">Status da Loja</h3>
                <div class="product-form">
                    <div class="form-group">
                        <label for="storeStatus">Status da Loja</label>
                        <div class="status-toggle">
                            <button type="button" class="btn status-btn active" data-status="open" 
                                    style="background: linear-gradient(135deg, var(--success) 0%, var(--success-light) 100%);">
                                <i class="fas fa-store"></i> Loja Aberta
                            </button>
                            <button type="button" class="btn status-btn" data-status="closed" 
                                    style="background: linear-gradient(135deg, var(--danger) 0%, var(--danger-light) 100%);">
                                <i class="fas fa-store-slash"></i> Loja Fechada
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="statusMessage">Mensagem de Status (Opcional)</label>
                        <textarea id="statusMessage" class="form-control" rows="4" 
                                  placeholder="Ex: 'Voltamos amanhã às 18h' ou 'Promoção especial hoje!'"></textarea>
                        <small style="color: #666;">Esta mensagem será exibida para os clientes quando a loja estiver aberta ou fechada.</small>
                    </div>
                    
                    <div class="form-group">
                        <label>Pré-visualização:</label>
                        <div id="statusPreview" style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 4px solid var(--success); margin-top: 10px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                <i class="fas fa-store" style="color: var(--success);"></i>
                                <strong style="color: var(--success);">Loja Aberta</strong>
                            </div>
                            <p id="previewMessage" style="margin: 0; color: #666;">Estamos abertos e prontos para atender!</p>
                        </div>
                    </div>
                    
                    <button class="btn" id="saveStatus">
                        <i class="fas fa-save"></i> Salvar Status
                    </button>
                </div>
            </div>
            
            <div class="admin-content" id="settingsTab">
                <h3 style="margin-bottom: 20px; color: var(--secondary);">Configurações do Sistema</h3>
                <div class="product-form">
                    <div class="form-group">
                        <label for="whatsappNumber">Número do WhatsApp</label>
                        <input type="text" id="whatsappNumber" class="form-control" value="5521973960077">
                    </div>
                    <div class="form-group">
                        <label for="storeName">Nome da Loja</label>
                        <input type="text" id="storeName" class="form-control" value="Nahora Delivery">
                    </div>
                    <div class="form-group">
                        <label for="deliveryFee">Taxa de Entrega (R$)</label>
                        <input type="number" id="deliveryFee" class="form-control" value="5.00" step="0.01" min="0">
                    </div>
                    <button class="btn" id="saveSettings">Salvar Configurações</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="contact">
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>Nahora Delivery</h3>
                    <p>Entregamos sabor e qualidade diretamente na sua porta. Experimente nossas delícias!</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                
                <div class="footer-column">
                    <h3>Links Rápidos</h3>
                    <ul>
                        <li><a href="#">Início</a></li>
                        <li><a href="#menu">Cardápio</a></li>
                        <li><a href="#about">Sobre Nós</a></li>
                        <li><a href="#contact">Contato</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3>Contato</h3>
                    <ul>
                        <li><i class="fas fa-phone"></i> (21) 97396-0077</li>
                        <li><i class="fas fa-envelope"></i> contato@nahoradelivery.com</li>
                        <li><i class="fas fa-map-marker-alt"></i> Rio de Janeiro, RJ</li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3>Horário de Funcionamento</h3>
                    <ul>
                        <li>Segunda a Sexta: 10h - 23h</li>
                        <li>Sábado e Domingo: 11h - 00h</li>
                        <li>Feriados: 11h - 22h</li>
                    </ul>
                </div>
            </div>
            
            <div class="copyright">
                &copy; 2023 Nahora Delivery. Todos os direitos reservados.
            </div>
        </div>
    </footer>

    <!-- Overlay -->
    <div class="overlay" id="overlay"></div>

    <script>
        // =============================================
        // CONFIGURAÇÃO DO BACKEND
        // =============================================
        const API_BASE_URL = 'http://localhost:3000/api';
        
        // =============================================
        // VARIÁVEIS GLOBAIS
        // =============================================
        let products = [];
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let editingProductId = null;
        let isLoggedIn = false;
        let uploadedImageFile = null;

        // Credenciais do admin
        const adminCredentials = {
            username: "admin",
            password: "123456"
        };

        // Placeholder images por categoria
        const PLACEHOLDER_IMAGES = {
            'Pizzas': 'https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=300&q=80',
            'Lanches': 'https://images.unsplash.com/photo-1571091718767-18b5b1457add?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=300&q=80',
            'Bebidas': 'https://images.unsplash.com/photo-1544145945-f90425340c7e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=300&q=80',
            'Sobremesas': 'https://images.unsplash.com/photo-1563729784474-d77dbb933a9e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=300&q=80',
            'default': 'https://images.unsplash.com/photo-1559339352-11d035aa65de?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=300&q=80'
        };

        // Sistema de Status da Loja
        let storeStatus = {
            isOpen: true,
            message: 'Estamos abertos e prontos para atender!',
            lastUpdated: new Date()
        };

        // =============================================
        // ELEMENTOS DOM
        // =============================================
        const productsGrid = document.getElementById('productsGrid');
        const adminProductsGrid = document.getElementById('adminProductsGrid');
        const cartIcon = document.getElementById('cartIcon');
        const cartSidebar = document.getElementById('cartSidebar');
        const closeCart = document.getElementById('closeCart');
        const cartItems = document.getElementById('cartItems');
        const cartTotal = document.getElementById('cartTotal');
        const cartCount = document.querySelector('.cart-count');
        const checkoutBtn = document.getElementById('checkoutBtn');
        const checkoutModal = document.getElementById('checkoutModal');
        const closeCheckoutModal = document.getElementById('closeCheckoutModal');
        const checkoutForm = document.getElementById('checkoutForm');
        const overlay = document.getElementById('overlay');
        const categoryBtns = document.querySelectorAll('.category-btn');
        const paymentOptions = document.querySelectorAll('.payment-option');
        const changeField = document.getElementById('changeField');
        const adminPanel = document.getElementById('adminPanel');
        const adminBtn = document.getElementById('adminBtn');
        const userSection = document.getElementById('userSection');
        const loginModal = document.getElementById('loginModal');
        const loginForm = document.getElementById('loginForm');
        const logoutBtn = document.getElementById('logoutBtn');
        const adminTabs = document.querySelectorAll('.admin-tab');
        const productForm = document.getElementById('productForm');
        const productImage = document.getElementById('productImage');
        const uploadImageBtn = document.getElementById('uploadImageBtn');
        const imagePreview = document.getElementById('imagePreview');
        const cancelEdit = document.getElementById('cancelEdit');
        const ordersList = document.getElementById('ordersList');

        // Elementos do Sistema de Status
        let statusTab, statusBtns, statusMessage, statusPreview, saveStatusBtn;

        // =============================================
        // SISTEMA DE STATUS DA LOJA
        // =============================================

        // Inicializar sistema de status
        function initStoreStatus() {
            loadStoreStatus();
            renderStoreStatus();
            setupStatusListeners();
        }

        // Carregar status do localStorage
        function loadStoreStatus() {
            const savedStatus = localStorage.getItem('storeStatus');
            if (savedStatus) {
                storeStatus = JSON.parse(savedStatus);
            }
        }

        // Salvar status no localStorage
        function saveStoreStatus() {
            localStorage.setItem('storeStatus', JSON.stringify(storeStatus));
            showNotification('Status da loja salvo com sucesso!', 'success');
        }

        // Configurar event listeners do status
        function setupStatusListeners() {
            statusTab = document.getElementById('statusTab');
            statusBtns = document.querySelectorAll('.status-btn');
            statusMessage = document.getElementById('statusMessage');
            statusPreview = document.getElementById('statusPreview');
            saveStatusBtn = document.getElementById('saveStatus');
            
            if (!statusTab) return;
            
            // Botões de status
            statusBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const status = this.dataset.status;
                    setStoreStatus(status === 'open');
                    updateStatusPreview();
                });
            });
            
            // Campo de mensagem
            if (statusMessage) {
                statusMessage.addEventListener('input', updateStatusPreview);
                statusMessage.value = storeStatus.message;
            }
            
            // Botão salvar
            if (saveStatusBtn) {
                saveStatusBtn.addEventListener('click', function() {
                    saveStoreStatus();
                    renderStoreStatus();
                });
            }
            
            // Atualizar preview inicial
            updateStatusPreview();
        }

        // Definir status da loja
        function setStoreStatus(isOpen) {
            storeStatus.isOpen = isOpen;
            storeStatus.lastUpdated = new Date();
            
            // Atualizar botões
            if (statusBtns) {
                statusBtns.forEach(btn => {
                    if (btn.dataset.status === (isOpen ? 'open' : 'closed')) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                });
            }
        }

        // Atualizar pré-visualização
        function updateStatusPreview() {
            if (!statusPreview) return;
            
            const message = statusMessage ? statusMessage.value : storeStatus.message;
            storeStatus.message = message;
            
            const isOpen = storeStatus.isOpen;
            const statusClass = isOpen ? 'open' : 'closed';
            const statusText = isOpen ? 'Loja Aberta' : 'Loja Fechada';
            const statusColor = isOpen ? 'var(--success)' : 'var(--danger)';
            const statusIcon = isOpen ? 'fa-store' : 'fa-store-slash';
            const defaultMessage = isOpen ? 'Estamos abertos e prontos para atender!' : 'No momento estamos fechados. Volte em breve!';
            
            statusPreview.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                    <i class="fas ${statusIcon}" style="color: ${statusColor};"></i>
                    <strong style="color: ${statusColor};">${statusText}</strong>
                </div>
                <p id="previewMessage" style="margin: 0; color: #666;">${message || defaultMessage}</p>
                <div style="margin-top: 10px; font-size: 0.8rem; color: #999;">
                    <i class="fas fa-clock"></i> Atualizado: ${new Date().toLocaleString('pt-BR')}
                </div>
            `;
            
            statusPreview.style.borderLeftColor = statusColor;
        }

        // Renderizar banner de status na página
        function renderStoreStatus() {
            // Remover banner existente
            const existingBanner = document.getElementById('statusBanner');
            if (existingBanner) {
                existingBanner.remove();
            }
            
            // Criar novo banner
            const banner = document.createElement('div');
            banner.id = 'statusBanner';
            banner.className = `status-banner ${storeStatus.isOpen ? 'open' : 'closed'}`;
            
            const statusText = storeStatus.isOpen ? 'Loja Aberta' : 'Loja Fechada';
            const statusIcon = storeStatus.isOpen ? 'fa-store' : 'fa-store-slash';
            const defaultMessage = storeStatus.isOpen ? '🟢 Estamos abertos!' : '🔴 Estamos fechados no momento.';
            
            banner.innerHTML = `
                <div class="container">
                    <div class="status-content">
                        <i class="fas ${statusIcon}"></i>
                        <span class="status-message">${storeStatus.message || defaultMessage}</span>
                        <small style="opacity: 0.8;">• Atualizado: ${storeStatus.lastUpdated.toLocaleString('pt-BR')}</small>
                    </div>
                </div>
            `;
            
            // Inserir após o header
            const header = document.querySelector('header');
            if (header) {
                header.parentNode.insertBefore(banner, header.nextSibling);
            }
            
            // Atualizar estado dos botões na loja
            updateStoreUI();
        }

        // Atualizar UI baseada no status
        function updateStoreUI() {
            const isOpen = storeStatus.isOpen;
            
            // Hero section
            const hero = document.querySelector('.hero');
            if (hero) {
                if (!isOpen) {
                    hero.classList.add('closed-store');
                } else {
                    hero.classList.remove('closed-store');
                }
            }
            
            // Botões de ação
            const actionButtons = document.querySelectorAll('.btn, .add-to-cart, .checkout-btn');
            actionButtons.forEach(btn => {
                if (!isOpen && !btn.closest('.admin-panel')) {
                    btn.disabled = true;
                    btn.style.opacity = '0.5';
                    btn.style.cursor = 'not-allowed';
                } else {
                    btn.disabled = false;
                    btn.style.opacity = '';
                    btn.style.cursor = '';
                }
            });
            
            // Mensagem no carrinho
            const cartCheckout = document.getElementById('checkoutBtn');
            if (cartCheckout && !isOpen) {
                cartCheckout.innerHTML = '<i class="fas fa-store-slash"></i> Loja Fechada';
            } else if (cartCheckout) {
                cartCheckout.innerHTML = 'Finalizar Pedido';
            }
        }

        // =============================================
        // FUNÇÕES PARA API
        // =============================================

        // Buscar produtos do servidor
        async function fetchProducts() {
            try {
                showLoading(true);
                const response = await fetch(`${API_BASE_URL}/products`);
                
                if (!response.ok) {
                    throw new Error('Erro ao carregar produtos');
                }
                
                const productsData = await response.json();
                console.log('📦 Produtos carregados:', productsData.length);
                
                return productsData;
            } catch (error) {
                console.error('Erro ao buscar produtos:', error);
                showNotification('Erro ao carregar produtos do servidor', 'danger');
                return [];
            } finally {
                showLoading(false);
            }
        }

        // Salvar produto no banco de dados
        async function saveProductToDatabase(productData) {
            try {
                showLoading(true);
                
                // Se tem imagem, usa FormData
                if (productData.imageFile) {
                    const formData = new FormData();
                    formData.append('name', productData.name);
                    formData.append('description', productData.description);
                    formData.append('price', productData.price.toString());
                    formData.append('category', productData.category);
                    formData.append('image', productData.imageFile);
                    
                    const url = productData.id 
                        ? `${API_BASE_URL}/products/${productData.id}`
                        : `${API_BASE_URL}/products`;
                    
                    const method = productData.id ? 'PUT' : 'POST';
                    
                    const response = await fetch(url, {
                        method: method,
                        body: formData
                    });
                    
                    if (!response.ok) {
                        throw new Error('Erro ao salvar produto com imagem');
                    }
                    
                    return await response.json();
                } else {
                    // Sem imagem, usa JSON
                    const url = productData.id 
                        ? `${API_BASE_URL}/products/${productData.id}`
                        : `${API_BASE_URL}/products/json`;
                    
                    const method = productData.id ? 'PUT' : 'POST';
                    
                    const response = await fetch(url, {
                        method: method,
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            name: productData.name,
                            description: productData.description,
                            price: productData.price,
                            category: productData.category
                        })
                    });
                    
                    if (!response.ok) {
                        const errorText = await response.text();
                        throw new Error(`Erro ${response.status}: ${errorText}`);
                    }
                    
                    return await response.json();
                }
                
            } catch (error) {
                console.error('❌ Erro ao salvar produto:', error);
                showNotification('Erro ao salvar produto: ' + error.message, 'danger');
                throw error;
            } finally {
                showLoading(false);
            }
        }

        // Deletar produto do servidor
        async function deleteProductFromDatabase(productId) {
            try {
                showLoading(true);
                
                const response = await fetch(`${API_BASE_URL}/products/${productId}`, {
                    method: 'DELETE'
                });
                
                if (!response.ok) {
                    throw new Error('Erro ao deletar produto');
                }
                
                const result = await response.json();
                showNotification('Produto deletado com sucesso!', 'success');
                return true;
                
            } catch (error) {
                console.error('Erro ao deletar produto:', error);
                showNotification('Erro ao deletar produto do servidor', 'danger');
                return false;
            } finally {
                showLoading(false);
            }
        }

        // =============================================
        // FUNÇÕES PRINCIPAIS - CORRIGIDAS (SEM PISCAR)
        // =============================================

        // Inicialização
        async function init() {
            console.log('🚀 Iniciando Nahora Delivery...');
            
            // Carregar status primeiro
            loadStoreStatus();
            renderStoreStatus();
            
            // Pequeno delay para estabilizar o DOM
            await new Promise(resolve => setTimeout(resolve, 100));
            
            await loadProducts();
            updateCart();
            checkLoginStatus();
            setupEventListeners();
            setupStatusListeners();
            
            console.log('✅ Sistema iniciado com sucesso!');
        }

        // Carregar produtos
        async function loadProducts() {
            products = await fetchProducts();
            renderProducts();
            if (isLoggedIn) {
                renderAdminProducts();
            }
        }

        // Função showLoading corrigida - SEM PISCAR
        function showLoading(show) {
            const loadingElements = document.querySelectorAll('.products-grid, .admin-content');
            loadingElements.forEach(el => {
                if (show) {
                    el.classList.add('loading');
                } else {
                    el.classList.remove('loading');
                    // Garantir que o conteúdo seja visível
                    el.style.opacity = '1';
                }
            });
        }

        // Renderizar produtos para clientes - CORRIGIDA (SEM PISCAR)
        function renderProducts(filterCategory = 'all') {
            if (!productsGrid) return;
            
            // Mostrar loading imediatamente
            productsGrid.classList.add('loading');
            
            // Usar setTimeout para garantir que o loading seja mostrado
            setTimeout(() => {
                productsGrid.classList.remove('loading');
                
                const filteredProducts = filterCategory === 'all' 
                    ? products 
                    : products.filter(product => product.category === filterCategory);
                
                if (filteredProducts.length === 0) {
                    productsGrid.innerHTML = `
                        <div style="grid-column: 1 / -1; text-align: center; padding: 40px;">
                            <i class="fas fa-utensils" style="font-size: 3rem; color: #ccc; margin-bottom: 15px;"></i>
                            <p style="color: #666;">Nenhum produto encontrado</p>
                        </div>
                    `;
                    return;
                }
                
                productsGrid.innerHTML = '';
                
                filteredProducts.forEach(product => {
                    const productCard = createProductCard(product, false);
                    productsGrid.appendChild(productCard);
                });

                // Re-attach event listeners
                document.querySelectorAll('.add-to-cart').forEach(button => {
                    button.addEventListener('click', addToCart);
                });
            }, 50);
        }

        // Renderizar produtos na área admin
        function renderAdminProducts() {
            if (!adminProductsGrid) return;
            
            adminProductsGrid.innerHTML = '';
            
            if (products.length === 0) {
                adminProductsGrid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 40px;">
                        <p>Nenhum produto cadastrado</p>
                    </div>
                `;
                return;
            }
            
            products.forEach(product => {
                const productCard = createProductCard(product, true);
                adminProductsGrid.appendChild(productCard);
            });
        }

        // Criar card de produto
        function createProductCard(product, isAdmin = false) {
            const productCard = document.createElement('div');
            productCard.className = 'product-card';
            
            // Imagem com fallback melhorado
            const imageUrl = product.image_url || 
                            PLACEHOLDER_IMAGES[product.category] || 
                            PLACEHOLDER_IMAGES['default'];
            
            const price = Number(product.price) || 0;
            
            if (isAdmin) {
                productCard.innerHTML = `
                    <img src="${imageUrl}" alt="${product.name}" class="product-image" 
                         onerror="this.src='${PLACEHOLDER_IMAGES['default']}'">
                    <div class="product-info">
                        <h3 class="product-name">${product.name || 'Sem Nome'}</h3>
                        <p class="product-description">${product.description || 'Sem descrição'}</p>
                        <div class="product-footer">
                            <span class="product-price">R$ ${price.toFixed(2)}</span>
                            <div style="display: flex; gap: 5px;">
                                <button class="btn" style="padding: 8px 12px; font-size: 0.8rem;" 
                                        onclick="editProduct(${product.id})">
                                    <i class="fas fa-edit"></i> Editar
                                </button>
                                <button class="btn" style="padding: 8px 12px; font-size: 0.8rem; background-color: var(--danger);" 
                                        onclick="deleteProduct(${product.id})">
                                    <i class="fas fa-trash"></i> Excluir
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                productCard.innerHTML = `
                    <img src="${imageUrl}" alt="${product.name}" class="product-image"
                         onerror="this.src='${PLACEHOLDER_IMAGES['default']}'">
                    <div class="product-info">
                        <h3 class="product-name">${product.name || 'Sem Nome'}</h3>
                        <p class="product-description">${product.description || 'Sem descrição'}</p>
                        <div class="product-footer">
                            <span class="product-price">R$ ${price.toFixed(2)}</span>
                            <button class="add-to-cart" data-id="${product.id}">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>
                `;
            }
            
            return productCard;
        }

        // =============================================
        // FUNÇÕES DO ADMIN
        // =============================================

        // Salvar produto
        async function saveProduct(e) {
            e.preventDefault();
            
            const productName = document.getElementById('productName').value;
            const productPrice = document.getElementById('productPrice').value;
            const productCategory = document.getElementById('productCategory').value;
            const productDescription = document.getElementById('productDescription').value;
            
            if (!productName || !productPrice || !productCategory) {
                showNotification('Preencha nome, preço e categoria!', 'danger');
                return;
            }
            
            const productData = {
                name: productName,
                description: productDescription,
                price: parseFloat(productPrice),
                category: productCategory,
                imageFile: uploadedImageFile
            };
            
            if (editingProductId) {
                productData.id = editingProductId;
            }
            
            try {
                console.log('💾 Salvando produto no banco...', productData);
                
                const savedProduct = await saveProductToDatabase(productData);
                
                // Atualizar lista local
                if (editingProductId) {
                    const index = products.findIndex(p => p.id === editingProductId);
                    if (index !== -1) {
                        products[index] = savedProduct;
                    }
                } else {
                    products.push(savedProduct);
                }
                
                // Atualizar views
                renderProducts();
                renderAdminProducts();
                
                // Resetar formulário
                resetProductForm();
                
                showNotification('✅ Produto salvo com sucesso!', 'success');
                
            } catch (error) {
                console.error('Erro ao salvar produto:', error);
            }
        }

        // Editar produto
        async function editProduct(id) {
            const product = products.find(p => p.id === id);
            
            if (product) {
                document.getElementById('productName').value = product.name || '';
                document.getElementById('productDescription').value = product.description || '';
                document.getElementById('productPrice').value = product.price || '';
                document.getElementById('productCategory').value = product.category || '';
                
                // Configurar preview
                if (imagePreview) {
                    imagePreview.innerHTML = product.image_url 
                        ? `<img src="${product.image_url}" alt="Preview" style="width: 100%; height: 100%; object-fit: cover;">`
                        : '<span style="color: #666; text-align: center; padding: 20px;">Imagem atual do produto</span>';
                }
                
                uploadedImageFile = null;
                editingProductId = id;
                
                if (cancelEdit) {
                    cancelEdit.style.display = 'inline-block';
                }
                
                showNotification(`Editando: ${product.name}`, 'info');
            }
        }

        // Deletar produto
        async function deleteProduct(id) {
            if (confirm('Tem certeza que deseja excluir este produto?')) {
                const success = await deleteProductFromDatabase(id);
                
                if (success) {
                    products = products.filter(p => p.id !== id);
                    renderProducts();
                    renderAdminProducts();
                }
            }
        }

        // Upload de imagem
        function handleImageUpload(e) {
            const file = e.target.files[0];
            
            if (file) {
                if (!file.type.match('image.*')) {
                    showNotification('Selecione apenas imagens!', 'danger');
                    return;
                }
                
                if (file.size > 5 * 1024 * 1024) {
                    showNotification('Imagem muito grande! Máximo 5MB.', 'danger');
                    return;
                }
                
                uploadedImageFile = file;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    if (imagePreview) {
                        imagePreview.innerHTML = `<img src="${e.target.result}" alt="Preview" style="width: 100%; height: 100%; object-fit: cover;">`;
                    }
                };
                reader.readAsDataURL(file);
            }
        }

        // Resetar formulário
        function resetProductForm() {
            if (productForm) productForm.reset();
            
            if (imagePreview) {
                imagePreview.innerHTML = '<span style="color: #666; text-align: center; padding: 20px;">Nenhuma imagem selecionada</span>';
            }
            
            uploadedImageFile = null;
            editingProductId = null;
            
            if (cancelEdit) {
                cancelEdit.style.display = 'none';
            }
        }

        // Cancelar edição
        function cancelEditProduct() {
            resetProductForm();
            showNotification('Edição cancelada', 'info');
        }

        // =============================================
        // FUNÇÕES DO CARRINHO
        // =============================================

        function addToCart(e) {
            // Verificar se a loja está aberta
            if (!storeStatus.isOpen) {
                showNotification('A loja está fechada no momento. Volte quando estivermos abertos!', 'warning');
                return;
            }
            
            const productId = parseInt(e.target.closest('.add-to-cart').dataset.id);
            const product = products.find(p => p.id === productId);
            
            if (!product) {
                showNotification('Produto não encontrado!', 'danger');
                return;
            }
            
            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    ...product,
                    quantity: 1
                });
            }
            
            updateCart();
            showNotification(`${product.name} adicionado ao carrinho!`, 'success');
        }

        function updateCart() {
            if (!cartItems) return;
            
            cartItems.innerHTML = '';
            
            if (cart.length === 0) {
                cartItems.innerHTML = '<p style="text-align: center; padding: 20px; color: #666;">Seu carrinho está vazio</p>';
                if (cartTotal) cartTotal.textContent = 'R$ 0,00';
                if (cartCount) cartCount.textContent = '0';
            } else {
                let total = 0;
                let count = 0;
                
                cart.forEach(item => {
                    const itemTotal = (Number(item.price) || 0) * item.quantity;
                    total += itemTotal;
                    count += item.quantity;
                    
                    const cartItem = document.createElement('div');
                    cartItem.className = 'cart-item';
                    cartItem.innerHTML = `
                        <img src="${item.image_url || PLACEHOLDER_IMAGES[item.category] || PLACEHOLDER_IMAGES['default']}" alt="${item.name}" class="cart-item-image">
                        <div class="cart-item-details">
                            <h4 class="cart-item-name">${item.name}</h4>
                            <span class="cart-item-price">R$ ${(Number(item.price) || 0).toFixed(2)}</span>
                            <div class="cart-item-actions">
                                <button class="quantity-btn decrease" data-id="${item.id}">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <span style="font-weight: bold; min-width: 30px; text-align: center;">${item.quantity}</span>
                                <button class="quantity-btn increase" data-id="${item.id}">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button class="remove-item" data-id="${item.id}">
                                    <i class="fas fa-trash"></i> Remover
                                </button>
                            </div>
                        </div>
                    `;
                    cartItems.appendChild(cartItem);
                });
                
                if (cartTotal) cartTotal.textContent = `R$ ${total.toFixed(2)}`;
                if (cartCount) cartCount.textContent = count;
                
                // Add event listeners to cart item buttons
                document.querySelectorAll('.decrease').forEach(button => {
                    button.addEventListener('click', decreaseQuantity);
                });
                
                document.querySelectorAll('.increase').forEach(button => {
                    button.addEventListener('click', increaseQuantity);
                });
                
                document.querySelectorAll('.remove-item').forEach(button => {
                    button.addEventListener('click', removeFromCart);
                });
            }
            
            // Save cart to localStorage
            localStorage.setItem('cart', JSON.stringify(cart));
        }
        
        // Decrease item quantity
        function decreaseQuantity(e) {
            const productId = parseInt(e.target.closest('button').dataset.id);
            const item = cart.find(item => item.id === productId);
            
            if (item.quantity > 1) {
                item.quantity -= 1;
            } else {
                cart = cart.filter(item => item.id !== productId);
            }
            
            updateCart();
        }
        
        // Increase item quantity
        function increaseQuantity(e) {
            const productId = parseInt(e.target.closest('button').dataset.id);
            const item = cart.find(item => item.id === productId);
            
            item.quantity += 1;
            updateCart();
        }
        
        // Remove item from cart
        function removeFromCart(e) {
            const productId = parseInt(e.target.closest('button').dataset.id);
            cart = cart.filter(item => item.id !== productId);
            updateCart();
            showNotification('Item removido do carrinho', 'info');
        }
        
        // Toggle cart sidebar
        function toggleCart() {
            cartSidebar.classList.toggle('active');
            overlay.classList.toggle('active');
        }
        
        // Open checkout modal
        function openCheckoutModal() {
            // Verificar se a loja está aberta
            if (!storeStatus.isOpen) {
                showNotification('A loja está fechada no momento. Não é possível finalizar pedidos.', 'warning');
                return;
            }
            
            if (cart.length === 0) {
                showNotification('Adicione itens ao carrinho antes de finalizar o pedido!', 'warning');
                return;
            }
            
            checkoutModal.classList.add('active');
            overlay.classList.add('active');
        }
        
        // Close modal
        function closeModal() {
            checkoutModal.classList.remove('active');
            overlay.classList.remove('active');
            loginModal.classList.remove('active');
        }
        
        // Close all modals
        function closeAllModals() {
            cartSidebar.classList.remove('active');
            checkoutModal.classList.remove('active');
            loginModal.classList.remove('active');
            overlay.classList.remove('active');
        }
        
        // Select payment method
        function selectPayment(e) {
            paymentOptions.forEach(option => {
                option.classList.remove('active');
            });
            
            e.target.closest('.payment-option').classList.add('active');
            
            const paymentMethod = e.target.closest('.payment-option').dataset.payment;
            document.getElementById('selectedPayment').value = paymentMethod;
            
            if (paymentMethod === 'dinheiro') {
                changeField.style.display = 'block';
            } else {
                changeField.style.display = 'none';
            }
        }

        // =============================================
        // FUNÇÕES WHATSAPP
        // =============================================

        // FUNÇÃO PARA VALIDAR FORMULÁRIO
        function validateCheckoutForm() {
            const customerName = document.getElementById('customerName').value.trim();
            const customerPhone = document.getElementById('customerPhone').value.trim();
            const deliveryAddress = document.getElementById('deliveryAddress').value.trim();
            const deliveryCity = document.getElementById('deliveryCity').value.trim();
            const paymentMethod = document.getElementById('selectedPayment').value;
            
            if (!customerName) {
                showNotification('Por favor, digite seu nome completo', 'warning');
                document.getElementById('customerName').focus();
                return false;
            }
            
            if (!customerPhone) {
                showNotification('Por favor, digite seu telefone', 'warning');
                document.getElementById('customerPhone').focus();
                return false;
            }
            
            if (!deliveryAddress) {
                showNotification('Por favor, digite o endereço de entrega', 'warning');
                document.getElementById('deliveryAddress').focus();
                return false;
            }
            
            if (!deliveryCity) {
                showNotification('Por favor, digite a cidade', 'warning');
                document.getElementById('deliveryCity').focus();
                return false;
            }
            
            if (!paymentMethod) {
                showNotification('Por favor, selecione a forma de pagamento', 'warning');
                return false;
            }
            
            return true;
        }

        // GERAR NÚMERO DO PEDIDO
        function generateOrderNumber() {
            const timestamp = Date.now().toString().slice(-6);
            const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
            return `ND${timestamp}${random}`;
        }

        // OBTER NOME DA FORMA DE PAGAMENTO
        function getPaymentMethodName(method) {
            const methods = {
                'dinheiro': '💵 Dinheiro',
                'cartao': '💳 Cartão de Crédito/Débito',
                'pix': '📱 PIX'
            };
            return methods[method] || method;
        }

        // GERAR MENSAGEM DETALHADA PARA WHATSAPP
        function generateWhatsAppMessage(orderData) {
            // Calcular totais
            const subtotal = orderData.items.reduce((sum, item) => sum + ((Number(item.price) || 0) * item.quantity), 0);
            const taxaEntrega = 5.00;
            const totalGeral = subtotal + taxaEntrega;
            
            let message = `🍕 *NOVO PEDIDO - NAHORA DELIVERY* 🍕\n`;
            message += `📋 *Nº do Pedido:* ${generateOrderNumber()}\n`;
            message += `⏰ *Data/Hora:* ${new Date().toLocaleString('pt-BR')}\n\n`;
            
            // DETALHES DO CLIENTE
            message += `👤 *DADOS DO CLIENTE:*\n`;
            message += `• Nome: ${orderData.customer.name}\n`;
            message += `• Telefone: ${orderData.customer.phone}\n`;
            if (orderData.customer.email && orderData.customer.email.trim() !== '') {
                message += `• E-mail: ${orderData.customer.email}\n`;
            }
            message += `\n`;
            
            // ENDEREÇO DE ENTREGA
            message += `📍 *ENDEREÇO DE ENTREGA:*\n`;
            message += `• Endereço: ${orderData.delivery.address}\n`;
            message += `• Cidade: ${orderData.delivery.city}\n`;
            if (orderData.delivery.zip && orderData.delivery.zip.trim() !== '') {
                message += `• CEP: ${orderData.delivery.zip}\n`;
            }
            if (orderData.delivery.notes && orderData.delivery.notes.trim() !== '') {
                message += `• Observações: ${orderData.delivery.notes}\n`;
            }
            message += `\n`;
            
            // ITENS DO PEDIDO
            message += `🛒 *ITENS DO PEDIDO:*\n`;
            message += `┌──────────────────────────────────────┐\n`;
            
            orderData.items.forEach((item, index) => {
                const itemTotal = (Number(item.price) || 0) * item.quantity;
                message += `│ ${item.quantity}x ${item.name}\n`;
                message += `│   R$ ${(Number(item.price) || 0).toFixed(2)} × ${item.quantity} = R$ ${itemTotal.toFixed(2)}\n`;
                if (index < orderData.items.length - 1) {
                    message += `│──────────────────────────────────────│\n`;
                }
            });
            
            message += `└──────────────────────────────────────┘\n\n`;
            
            // RESUMO DE VALORES
            message += `💰 *RESUMO DO PEDIDO:*\n`;
            message += `• Subtotal: R$ ${subtotal.toFixed(2)}\n`;
            message += `• Taxa de Entrega: R$ ${taxaEntrega.toFixed(2)}\n`;
            message += `• *TOTAL: R$ ${totalGeral.toFixed(2)}*\n\n`;
            
            // FORMA DE PAGAMENTO
            message += `💳 *FORMA DE PAGAMENTO:*\n`;
            message += `• ${getPaymentMethodName(orderData.payment)}\n`;
            if (orderData.payment === 'dinheiro' && orderData.changeFor) {
                const changeValue = parseFloat(orderData.changeFor) || 0;
                message += `• Troco para: R$ ${changeValue.toFixed(2)}\n`;
                const troco = changeValue - totalGeral;
                if (troco > 0) {
                    message += `• Troco a devolver: R$ ${troco.toFixed(2)}\n`;
                }
            }
            message += `\n`;
            
            // TEMPO ESTIMADO E INFORMAÇÕES ADICIONAIS
            message += `⏱️ *TEMPO ESTIMADO:* 30-45 minutos\n`;
            message += `📞 *CONTATO:* (21) 97396-0077\n\n`;
            
            message += `🙏 *Agradecemos pela preferência!* 🎉\n`;
            message += `*Nahora Delivery* - Entregando sabor até você!`;
            
            return message;
        }

        // ENVIAR PEDIDO PARA WHATSAPP
        function sendOrderToWhatsApp(orderData) {
            try {
                // Gerar mensagem formatada
                const whatsappMessage = generateWhatsAppMessage(orderData);
                
                // Número do WhatsApp (formato internacional sem +)
                const phoneNumber = "5521973960077";
                
                // Codificar mensagem para URL
                const encodedMessage = encodeURIComponent(whatsappMessage);
                
                // Criar URL do WhatsApp
                const whatsappURL = `https://wa.me/${phoneNumber}?text=${encodedMessage}`;
                
                console.log('📤 Enviando pedido para WhatsApp...');
                
                // Abrir WhatsApp em nova aba
                window.open(whatsappURL, '_blank');
                
                return true;
                
            } catch (error) {
                console.error('❌ Erro ao enviar para WhatsApp:', error);
                showNotification('Erro ao abrir WhatsApp. Tente novamente.', 'danger');
                return false;
            }
        }

        // =============================================
        // FUNÇÕES PARA GERENCIAR PEDIDOS
        // =============================================

        // Obter pedidos do localStorage
        function getOrders() {
            try {
                const orders = localStorage.getItem('customerOrders');
                return orders ? JSON.parse(orders) : [];
            } catch (error) {
                console.error('Erro ao carregar pedidos:', error);
                return [];
            }
        }

        // Salvar pedidos no localStorage
        function saveOrders(orders) {
            try {
                localStorage.setItem('customerOrders', JSON.stringify(orders));
                return true;
            } catch (error) {
                console.error('Erro ao salvar pedidos:', error);
                return false;
            }
        }

        // SALVAR PEDIDO LOCALMENTE
        function saveOrderLocally(orderData) {
            try {
                const orders = getOrders();
                orders.push({
                    ...orderData,
                    id: Date.now(),
                    status: 'enviado',
                    date: new Date().toISOString()
                });
                saveOrders(orders);
                renderOrders();
            } catch (error) {
                console.error('Erro ao salvar pedido localmente:', error);
            }
        }

        // Renderizar lista de pedidos
        function renderOrders() {
            if (!ordersList) return;
            
            const orders = getOrders();
            
            if (orders.length === 0) {
                ordersList.innerHTML = `
                    <div style="text-align: center; padding: 40px; background: white; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.1);">
                        <i class="fas fa-clipboard-list" style="font-size: 3rem; color: #ccc; margin-bottom: 15px;"></i>
                        <h3 style="color: #666; margin-bottom: 10px;">Nenhum pedido recebido ainda</h3>
                        <p style="color: #888;">Quando os clientes fizerem pedidos, eles aparecerão aqui.</p>
                    </div>
                `;
                return;
            }
            
            let ordersHTML = `
                <div style="display: grid; gap: 20px;">
            `;
            
            // Ordenar pedidos por data (mais recentes primeiro)
            const sortedOrders = orders.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            sortedOrders.forEach(order => {
                const orderDate = new Date(order.date).toLocaleString('pt-BR');
                const total = order.items.reduce((sum, item) => sum + ((Number(item.price) || 0) * item.quantity), 0) + 5.00;
                
                // Determinar cor do status
                let statusClass = 'pending';
                let statusText = 'Pendente';
                
                if (order.status === 'enviado') {
                    statusClass = 'pending';
                    statusText = 'Enviado';
                } else if (order.status === 'confirmado') {
                    statusClass = 'confirmed';
                    statusText = 'Confirmado';
                } else if (order.status === 'entregue') {
                    statusClass = 'delivered';
                    statusText = 'Entregue';
                } else if (order.status === 'cancelado') {
                    statusClass = 'cancelled';
                    statusText = 'Cancelado';
                }
                
                ordersHTML += `
                    <div class="order-card">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px; flex-wrap: wrap; gap: 10px;">
                            <div style="flex: 1; min-width: 200px;">
                                <h4 style="margin: 0 0 5px 0; color: var(--secondary);">Pedido #${order.id}</h4>
                                <p style="margin: 0; color: #666; font-size: 0.9rem;">${orderDate}</p>
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">
                                <span class="order-status ${statusClass}">${statusText}</span>
                                <button class="btn" style="padding: 5px 10px; font-size: 0.8rem;" onclick="viewOrderDetails(${order.id})">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                            <div>
                                <strong style="display: block; margin-bottom: 5px; font-size: 0.9rem;">Cliente</strong>
                                <span style="font-size: 0.9rem;">${order.customer.name}</span>
                            </div>
                            <div>
                                <strong style="display: block; margin-bottom: 5px; font-size: 0.9rem;">Telefone</strong>
                                <span style="font-size: 0.9rem;">${order.customer.phone}</span>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <strong style="display: block; margin-bottom: 5px; font-size: 0.9rem;">Endereço</strong>
                            <span style="font-size: 0.9rem;">${order.delivery.address}, ${order.delivery.city}</span>
                        </div>
                        
                        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;">
                            <div>
                                <strong style="display: block; margin-bottom: 5px; font-size: 0.9rem;">Total</strong>
                                <span style="font-size: 1.1rem; font-weight: bold; color: var(--primary);">R$ ${total.toFixed(2)}</span>
                            </div>
                            <div style="display: flex; gap: 5px; flex-wrap: wrap;">
                                ${order.status === 'enviado' ? `
                                    <button class="btn" style="padding: 5px 10px; font-size: 0.8rem; background: var(--success);" onclick="updateOrderStatus(${order.id}, 'confirmado')">
                                        <i class="fas fa-check"></i> Confirmar
                                    </button>
                                ` : ''}
                                ${order.status === 'confirmado' ? `
                                    <button class="btn" style="padding: 5px 10px; font-size: 0.8rem; background: var(--success);" onclick="updateOrderStatus(${order.id}, 'entregue')">
                                        <i class="fas fa-truck"></i> Entregue
                                    </button>
                                ` : ''}
                                ${order.status !== 'cancelado' && order.status !== 'entregue' ? `
                                    <button class="btn" style="padding: 5px 10px; font-size: 0.8rem; background: var(--danger);" onclick="updateOrderStatus(${order.id}, 'cancelado')">
                                        <i class="fas fa-times"></i> Cancelar
                                    </button>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;
            });
            
            ordersHTML += `</div>`;
            ordersList.innerHTML = ordersHTML;
        }

        // Visualizar detalhes do pedido
        function viewOrderDetails(orderId) {
            const orders = getOrders();
            const order = orders.find(o => o.id === orderId);
            
            if (!order) {
                showNotification('Pedido não encontrado!', 'danger');
                return;
            }
            
            const total = order.items.reduce((sum, item) => sum + ((Number(item.price) || 0) * item.quantity), 0) + 5.00;
            
            let itemsHTML = '';
            order.items.forEach(item => {
                const itemTotal = (Number(item.price) || 0) * item.quantity;
                itemsHTML += `
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #eee; flex-wrap: wrap;">
                        <div style="flex: 1;">
                            <strong>${item.quantity}x ${item.name}</strong>
                            <p style="margin: 0; color: #666; font-size: 0.9rem;">R$ ${(Number(item.price) || 0).toFixed(2)} cada</p>
                        </div>
                        <span style="font-weight: bold; color: var(--primary);">R$ ${itemTotal.toFixed(2)}</span>
                    </div>
                `;
            });
            
            const modalHTML = `
                <div class="modal active" id="orderDetailsModal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3>Detalhes do Pedido #${order.id}</h3>
                            <button class="close-modal" onclick="closeOrderDetails()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <h4 style="color: var(--secondary); margin-bottom: 10px;">Informações do Cliente</h4>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                                <p><strong>Nome:</strong> ${order.customer.name}</p>
                                <p><strong>Telefone:</strong> ${order.customer.phone}</p>
                                ${order.customer.email ? `<p><strong>E-mail:</strong> ${order.customer.email}</p>` : ''}
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <h4 style="color: var(--secondary); margin-bottom: 10px;">Endereço de Entrega</h4>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                                <p><strong>Endereço:</strong> ${order.delivery.address}</p>
                                <p><strong>Cidade:</strong> ${order.delivery.city}</p>
                                ${order.delivery.zip ? `<p><strong>CEP:</strong> ${order.delivery.zip}</p>` : ''}
                                ${order.delivery.notes ? `<p><strong>Observações:</strong> ${order.delivery.notes}</p>` : ''}
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <h4 style="color: var(--secondary); margin-bottom: 10px;">Itens do Pedido</h4>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                                ${itemsHTML}
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <h4 style="color: var(--secondary); margin-bottom: 10px;">Pagamento</h4>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                                <p><strong>Forma de pagamento:</strong> ${getPaymentMethodName(order.payment)}</p>
                                ${order.changeFor ? `<p><strong>Troco para:</strong> R$ ${parseFloat(order.changeFor).toFixed(2)}</p>` : ''}
                            </div>
                        </div>
                        
                        <div style="background: var(--primary); color: white; padding: 15px; border-radius: 8px; text-align: center;">
                            <h3 style="margin: 0; font-size: 1.5rem;">Total: R$ ${total.toFixed(2)}</h3>
                        </div>
                    </div>
                </div>
            `;
            
            // Adicionar modal ao body
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            overlay.classList.add('active');
        }

        // Fechar detalhes do pedido
        function closeOrderDetails() {
            const modal = document.getElementById('orderDetailsModal');
            if (modal) {
                modal.remove();
            }
            overlay.classList.remove('active');
        }

        // Atualizar status do pedido
        function updateOrderStatus(orderId, newStatus) {
            const orders = getOrders();
            const orderIndex = orders.findIndex(o => o.id === orderId);
            
            if (orderIndex === -1) {
                showNotification('Pedido não encontrado!', 'danger');
                return;
            }
            
            const statusNames = {
                'enviado': 'Enviado',
                'confirmado': 'Confirmado',
                'entregue': 'Entregue',
                'cancelado': 'Cancelado'
            };
            
            if (confirm(`Deseja realmente marcar o pedido #${orderId} como "${statusNames[newStatus]}"?`)) {
                orders[orderIndex].status = newStatus;
                saveOrders(orders);
                renderOrders();
                showNotification(`Pedido #${orderId} atualizado para "${statusNames[newStatus]}"!`, 'success');
            }
        }

        // SUBMIT ORDER
        function submitOrder(e) {
            e.preventDefault();
            
            if (cart.length === 0) {
                showNotification('Seu carrinho está vazio!', 'warning');
                return;
            }
            
            // Validar formulário antes de continuar
            if (!validateCheckoutForm()) {
                return;
            }
            
            // Coletar dados do formulário
            const customerName = document.getElementById('customerName').value.trim();
            const customerPhone = document.getElementById('customerPhone').value.trim();
            const customerEmail = document.getElementById('customerEmail').value.trim();
            const deliveryAddress = document.getElementById('deliveryAddress').value.trim();
            const deliveryCity = document.getElementById('deliveryCity').value.trim();
            const deliveryZip = document.getElementById('deliveryZip').value.trim();
            const deliveryNotes = document.getElementById('deliveryNotes').value.trim();
            const paymentMethod = document.getElementById('selectedPayment').value;
            const changeFor = document.getElementById('changeFor').value.trim();
            
            // Criar objeto orderData
            const orderData = {
                customer: {
                    name: customerName,
                    phone: customerPhone,
                    email: customerEmail
                },
                delivery: {
                    address: deliveryAddress,
                    city: deliveryCity,
                    zip: deliveryZip,
                    notes: deliveryNotes
                },
                payment: paymentMethod,
                changeFor: changeFor,
                items: cart,
                total: cart.reduce((sum, item) => sum + ((Number(item.price) || 0) * item.quantity), 0),
                date: new Date().toLocaleString('pt-BR')
            };
            
            console.log('🛒 Dados do pedido:', orderData);
            
            // Enviar para WhatsApp
            const success = sendOrderToWhatsApp(orderData);
            
            if (success) {
                // Mostrar confirmação
                showNotification('✅ Pedido enviado com sucesso! Em breve entraremos em contato para confirmar.', 'success');
                
                // Limpar carrinho e fechar modais
                cart = [];
                updateCart();
                closeAllModals();
                checkoutForm.reset();
                
                // Resetar opções de pagamento
                paymentOptions.forEach(option => {
                    option.classList.remove('active');
                });
                changeField.style.display = 'none';
                
                // Salvar pedido localmente
                saveOrderLocally(orderData);
            }
        }

        // =============================================
        // FUNÇÕES DE AUTENTICAÇÃO
        // =============================================

        // Check login status
        function checkLoginStatus() {
            const savedLogin = localStorage.getItem('adminLoggedIn');
            if (savedLogin === 'true') {
                isLoggedIn = true;
                updateUIForLoggedInUser();
            }
        }
        
        // Update UI for logged in user
        function updateUIForLoggedInUser() {
            userSection.innerHTML = `
                <div class="user-info">
                    <span>Olá, <strong>Admin</strong></span>
                    <button class="logout-btn" id="headerLogoutBtn">
                        <i class="fas fa-sign-out-alt"></i> Sair
                    </button>
                </div>
            `;
            
            // Add event listener to the new logout button
            document.getElementById('headerLogoutBtn').addEventListener('click', handleLogout);
        }
        
        // Handle admin access
        function handleAdminAccess() {
            if (isLoggedIn) {
                adminPanel.style.display = 'block';
                renderAdminProducts();
                renderOrders();
                window.scrollTo({ top: adminPanel.offsetTop, behavior: 'smooth' });
            } else {
                loginModal.classList.add('active');
                overlay.classList.add('active');
            }
        }
        
        // Handle login
        function handleLogin(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username === adminCredentials.username && password === adminCredentials.password) {
                isLoggedIn = true;
                localStorage.setItem('adminLoggedIn', 'true');
                
                loginModal.classList.remove('active');
                overlay.classList.remove('active');
                
                updateUIForLoggedInUser();
                showNotification('Login realizado com sucesso!', 'success');
                
                // Open admin panel after login
                adminPanel.style.display = 'block';
                renderAdminProducts();
                renderOrders();
                window.scrollTo({ top: adminPanel.offsetTop, behavior: 'smooth' });
            } else {
                showNotification('Usuário ou senha incorretos!', 'danger');
            }
        }
        
        // Handle logout
        function handleLogout() {
            isLoggedIn = false;
            localStorage.removeItem('adminLoggedIn');
            
            userSection.innerHTML = `
                <button class="admin-btn" id="adminBtn">
                    <i class="fas fa-cog"></i>
                    <span>Admin</span>
                </button>
            `;
            
            // Re-add event listener to the new admin button
            document.getElementById('adminBtn').addEventListener('click', handleAdminAccess);
            
            adminPanel.style.display = 'none';
            showNotification('Logout realizado com sucesso!', 'info');
        }

        // =============================================
        // FUNÇÕES DE UTILIDADE
        // =============================================

        function showNotification(message, type = 'info') {
            // Remove existing notifications
            document.querySelectorAll('.notification').forEach(notification => {
                notification.remove();
            });
            
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'danger' ? 'exclamation-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            // Remove after 4 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.style.animation = 'slideOut 0.3s ease-in';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }
            }, 4000);
        }

        function filterProducts(e) {
            const category = e.target.dataset.category;
            
            // Update active button
            categoryBtns.forEach(btn => {
                btn.classList.remove('active');
            });
            e.target.classList.add('active');
            
            // Filter products
            renderProducts(category);
        }

        function setupEventListeners() {
            // Event Listeners
            if (cartIcon) cartIcon.addEventListener('click', toggleCart);
            if (closeCart) closeCart.addEventListener('click', toggleCart);
            if (checkoutBtn) checkoutBtn.addEventListener('click', openCheckoutModal);
            if (closeCheckoutModal) closeCheckoutModal.addEventListener('click', closeModal);
            if (overlay) overlay.addEventListener('click', closeAllModals);
            
            categoryBtns.forEach(btn => {
                btn.addEventListener('click', filterProducts);
            });
            
            paymentOptions.forEach(option => {
                option.addEventListener('click', selectPayment);
            });
            
            if (checkoutForm) checkoutForm.addEventListener('submit', submitOrder);
            
            if (adminBtn) adminBtn.addEventListener('click', handleAdminAccess);
            if (loginForm) loginForm.addEventListener('submit', handleLogin);
            if (logoutBtn) logoutBtn.addEventListener('click', handleLogout);
            
            adminTabs.forEach(tab => {
                tab.addEventListener('click', switchAdminTab);
            });
            
            if (productForm) productForm.addEventListener('submit', saveProduct);
            if (uploadImageBtn) uploadImageBtn.addEventListener('click', () => productImage.click());
            if (productImage) productImage.addEventListener('change', handleImageUpload);
            if (cancelEdit) cancelEdit.addEventListener('click', cancelEditProduct);
        }

        // Admin functionality
        function switchAdminTab(e) {
            const tabId = e.target.dataset.tab;
            
            adminTabs.forEach(tab => {
                tab.classList.remove('active');
            });
            
            e.target.classList.add('active');
            
            document.querySelectorAll('.admin-content').forEach(content => {
                content.classList.remove('active');
            });
            
            document.getElementById(`${tabId}Tab`).classList.add('active');
            
            // Se for a aba de status, inicializar
            if (tabId === 'status') {
                updateStatusPreview();
            }
            
            // Se for a aba de pedidos, renderizar os pedidos
            if (tabId === 'orders') {
                renderOrders();
            }
        }

        // =============================================
        // INICIALIZAÇÃO
        // =============================================

        // Make functions available globally for onclick handlers
        window.editProduct = editProduct;
        window.deleteProduct = deleteProduct;
        window.cancelEditProduct = cancelEditProduct;
        window.viewOrderDetails = viewOrderDetails;
        window.closeOrderDetails = closeOrderDetails;
        window.updateOrderStatus = updateOrderStatus;
        
        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>